<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme-color" content="#6366f1">
  <meta name="description" content="DD CRM User Dashboard - Manage your leads efficiently">
  <title>DD CRM - User Dashboard</title>
  
  <!-- DNS Prefetch & Preconnect for faster external resource loading -->
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
  <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Optimized resource loading -->
  <link rel="preload" href="css/style.css" as="style">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Sidebar Navigation -->
  <div class="sidebar">
    <div class="sidebar-logo">
      <h1>DD CRM</h1>
    </div>
    
    <div class="sidebar-nav">
      <a href="#" class="sidebar-nav-item active" data-section="dashboard">
        <i class="fas fa-chart-line"></i>
        <span>Dashboard</span>
      </a>
      <a href="#" class="sidebar-nav-item" data-section="leads">
        <i class="fas fa-address-book"></i>
        <span>My Leads</span>
      </a>
      <a href="#" class="sidebar-nav-item" data-section="brochures">
        <i class="fas fa-file-pdf"></i>
        <span>Brochures</span>
      </a>
      <a href="#" class="sidebar-nav-item" data-section="analytics">
        <i class="fas fa-chart-bar"></i>
        <span>Analytics</span>
      </a>
    </div>
    
    <div class="sidebar-footer">
      <div class="sidebar-user">
        <div class="sidebar-user-avatar">U</div>
        <div class="sidebar-user-info">
          <div class="sidebar-user-name" id="user-name-sidebar">User</div>
          <div class="sidebar-user-role">Sales Rep</div>
        </div>
      </div>
      <button onclick="startTutorial()" class="btn btn-secondary" style="width: 100%; margin-bottom: 8px; background: rgba(102, 126, 234, 0.1); color: #667eea; border: 1px solid rgba(102, 126, 234, 0.2);">
        <i class="fas fa-question-circle"></i> Show Tutorial
      </button>
      <button onclick="logout()" class="btn btn-secondary" style="width: 100%;">
        <i class="fas fa-sign-out-alt"></i> Logout
      </button>
    </div>
  </div>
  
  <!-- Top Header -->
  <div class="top-header">
    <div class="header-title">
      <i class="fas fa-user-circle" style="margin-right: 8px; color: #6366f1;"></i>
      My Leads Dashboard
    </div>
    <div class="header-actions" style="display: flex; align-items: center; gap: 20px;">
      <!-- Notification Bell Icon -->
      <div style="position: relative; cursor: pointer;" onclick="toggleNotificationPanel()">
        <i class="fas fa-bell" id="notification-bell" style="font-size: 20px; color: #6b7280; transition: color 0.3s;"></i>
        <span id="notification-badge" style="position: absolute; top: -8px; right: -8px; background: #ef4444; color: white; border-radius: 50%; width: 18px; height: 18px; font-size: 11px; font-weight: 600; display: none; align-items: center; justify-content: center; border: 2px solid white; line-height: 1;">0</span>
      </div>
      <span id="user-name" style="color: #6b7280; font-size: 13px; font-weight: 500;"></span>
    </div>
  </div>
  
  <!-- Live Update Notification Banner -->
  <div id="update-notification-banner" style="display: none; position: fixed; top: 64px; left: 240px; right: 0; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; padding: 12px 28px; z-index: 9000; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-bottom: 3px solid #1d4ed8;">
    <div style="display: flex; align-items: center; justify-content: space-between; max-width: 1600px;">
      <div style="display: flex; align-items: center; gap: 12px;">
        <i class="fas fa-sync-alt" style="font-size: 18px; animation: spin 2s linear infinite;"></i>
        <div>
          <div style="font-weight: 600; font-size: 14px;">Updates Available</div>
          <div id="update-notification-message" style="font-size: 12px; opacity: 0.95;">Your lead data has been updated by admin. Click to refresh and see the latest changes.</div>
        </div>
      </div>
      <div style="display: flex; gap: 10px;">
        <button id="refresh-data-btn" style="background: white; color: #2563eb; border: none; padding: 8px 16px; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 13px; transition: all 0.2s;">
          <i class="fas fa-redo" style="margin-right: 6px;"></i>Refresh Now
        </button>
        <button id="dismiss-notification-btn" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 13px; transition: all 0.2s;">
          Dismiss
        </button>
      </div>
    </div>
  </div>
  
  <div class="container with-header">
    <div class="dashboard">
      
      <!-- Search & Filter Bar -->
      <div class="card" style="margin-bottom: 18px;">
        <div style="display: flex; gap: 14px; align-items: center; flex-wrap: wrap;">
          <div style="flex: 1; min-width: 250px; position: relative;">
            <i class="fas fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #9ca3af;"></i>
            <input type="text" id="filter-search" placeholder="Search by name, email, city, university, course..." style="width: 100%; padding: 11px 12px 11px 36px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 14px;">
          </div>
          <select id="filter-status" style="padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 14px; min-width: 180px;">
            <option value="">All Statuses</option>
            <option value="Fresh">Fresh</option>
            <option value="Buffer fresh">Buffer fresh</option>
            <option value="Did not pick">Did not pick</option>
            <option value="Request call back">Request call back</option>
            <option value="Follow up">Follow up</option>
            <option value="Counselled">Counselled</option>
            <option value="Interested in next batch">Interested in next batch</option>
            <option value="Registration fees paid">Registration fees paid</option>
            <option value="Enrolled">Enrolled</option>
            <option value="Junk/not interested">Junk/not interested</option>
          </select>
          <select id="filter-source" style="padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 14px; min-width: 160px;">
            <option value="">All Sources</option>
          </select>
          <select id="filter-date" style="padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 14px; min-width: 150px;">
            <option value="">All Time</option>
            <option value="today">Today</option>
            <option value="yesterday">Yesterday</option>
            <option value="thisweek">This Week</option>
            <option value="lastweek">Last Week</option>
            <option value="thismonth">This Month</option>
            <option value="custom">Custom Date</option>
          </select>
          <input type="date" id="filter-custom-date" style="display: none; padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 14px;">
          <button onclick="toggleUserNoActionFilter()" class="btn btn-secondary" style="white-space: nowrap;">
            <i class="fas fa-user-clock"></i> No Action Taken
          </button>
          <button onclick="clearFilters()" class="btn btn-secondary" style="white-space: nowrap;">
            <i class="fas fa-times"></i> Clear
          </button>
        </div>
      </div>

      <!-- No Action Filter Panel (User) -->
      <div id="user-no-action-filter-panel" style="display: none; margin-bottom: 16px; padding: 14px; background: #fef3c7; border: 1px solid #fde68a; border-radius: 8px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <h4 style="margin: 0; color: #92400e; font-size: 14px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-exclamation-triangle"></i> Leads with No Action Taken
          </h4>
          <button onclick="clearUserNoActionFilter()" class="btn btn-secondary" style="font-size: 12px; padding: 4px 8px;">
            <i class="fas fa-times"></i> Clear
          </button>
        </div>
        <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
          <div style="display: flex; align-items: center; gap: 8px;">
            <label style="font-size: 13px; color: #78350f; font-weight: 500;">Show leads with no activity for:</label>
            <select id="user-no-action-period" style="padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 13px; background: white; min-width: 150px;">
              <option value="1">Last 24 Hours</option>
              <option value="3">Last 3 Days</option>
              <option value="7" selected>Last 7 Days</option>
              <option value="15">Last 15 Days</option>
              <option value="30">Last 30 Days</option>
              <option value="custom">Custom Range</option>
            </select>
          </div>
          <div id="user-no-action-custom-dates" style="display: none; gap: 8px; align-items: center;">
            <input type="date" id="user-no-action-start-date" style="padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px;">
            <span style="color: #6b7280;">to</span>
            <input type="date" id="user-no-action-end-date" style="padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px;">
          </div>
          <button onclick="applyUserNoActionFilter()" class="btn btn-primary" style="font-size: 13px; padding: 6px 14px;">
            <i class="fas fa-check"></i> Apply Filter
          </button>
        </div>
        <div id="user-no-action-filter-status" style="margin-top: 8px; font-size: 12px; color: #78350f;">
          <i class="fas fa-info-circle"></i> Shows leads assigned to you with no status change or note in the selected period.
        </div>
      </div>
      
      <!-- Status Filter Buttons -->
      <div id="status-filter-section" class="card" style="margin-bottom: 26px;">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 18px;">
          <i class="fas fa-filter" style="color: #6366f1;"></i>
          Filter by Status
        </h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
          <button onclick="quickFilter('')" class="status-filter-btn status-filter-all">
            <i class="fas fa-list"></i>
            <div>
              <div class="status-filter-label">All Leads</div>
              <div class="status-filter-count" id="count-all">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Fresh')" class="status-filter-btn status-filter-fresh">
            <i class="fas fa-star"></i>
            <div>
              <div class="status-filter-label">Fresh</div>
              <div class="status-filter-count" id="count-fresh">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Buffer fresh')" class="status-filter-btn status-filter-buffer">
            <i class="fas fa-clock"></i>
            <div>
              <div class="status-filter-label">Buffer Fresh</div>
              <div class="status-filter-count" id="count-buffer-fresh">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Did not pick')" class="status-filter-btn status-filter-not-picked">
            <i class="fas fa-phone-slash"></i>
            <div>
              <div class="status-filter-label">Did Not Pick</div>
              <div class="status-filter-count" id="count-did-not-pick">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Request call back')" class="status-filter-btn status-filter-callback">
            <i class="fas fa-phone-volume"></i>
            <div>
              <div class="status-filter-label">Request Call Back</div>
              <div class="status-filter-count" id="count-request-call-back">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Follow up')" class="status-filter-btn status-filter-followup">
            <i class="fas fa-phone"></i>
            <div>
              <div class="status-filter-label">Follow Up</div>
              <div class="status-filter-count" id="count-follow-up">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Counselled')" class="status-filter-btn status-filter-counselled">
            <i class="fas fa-comments"></i>
            <div>
              <div class="status-filter-label">Counselled</div>
              <div class="status-filter-count" id="count-counselled">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Interested in next batch')" class="status-filter-btn status-filter-interested">
            <i class="fas fa-calendar-alt"></i>
            <div>
              <div class="status-filter-label">Interested in Next Batch</div>
              <div class="status-filter-count" id="count-interested">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Registration fees paid')" class="status-filter-btn status-filter-fees-paid">
            <i class="fas fa-money-bill-wave"></i>
            <div>
              <div class="status-filter-label">Registration Fees Paid</div>
              <div class="status-filter-count" id="count-fees-paid">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Enrolled')" class="status-filter-btn status-filter-enrolled">
            <i class="fas fa-graduation-cap"></i>
            <div>
              <div class="status-filter-label">Enrolled</div>
              <div class="status-filter-count" id="count-enrolled">0</div>
            </div>
          </button>
          <button onclick="quickFilter('Junk/not interested')" class="status-filter-btn status-filter-junk">
            <i class="fas fa-trash-alt"></i>
            <div>
              <div class="status-filter-label">Junk/Not Interested</div>
              <div class="status-filter-count" id="count-junk">0</div>
            </div>
          </button>
        </div>
      </div>
      
      <!-- Leads List -->
      <div class="card" id="leads-section">
        <h2 style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;">
          <span style="display: flex; align-items: center;">
            <i class="fas fa-address-book" style="margin-right: 8px; color: #6366f1;"></i>
            My Leads
          </span>
          <span id="leads-count" style="font-size: 14px; font-weight: 500; color: #6b7280;">0 leads</span>
        </h2>
        <div id="leads-container"></div>
      </div>

      <!-- Brochures Section -->
      <div class="card" id="brochures-section" style="display:none;">
        <h2 style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 14px; margin-bottom: 18px;">
          <span style="display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-file-pdf" style="margin-right: 8px; color: #e11d48;"></i>
            Course Brochures
          </span>
          <button onclick="downloadAllBrochures()" class="btn btn-primary" style="font-size: 14px; display: flex; align-items: center; gap: 6px;">
            <i class="fas fa-download"></i>
            Download All as ZIP
          </button>
        </h2>
        
        <div style="display: flex; gap: 14px; margin-bottom: 18px; flex-wrap: wrap;">
          <select id="filter-university" style="padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 14px; flex: 1; min-width: 200px;">
            <option value="">Select University</option>
          </select>
        </div>
        
        <div id="brochures-list">
          <p style="color: #9ca3af; font-size: 14px; text-align: center; padding: 20px 0;">Select a university to view brochures.</p>
        </div>
      </div>
      
      <!-- Analytics Section -->
      <div id="analytics-section" style="margin-top: 26px;">
        <h2 style="margin-bottom: 18px; display: flex; align-items: center; gap: 8px;">
          <i class="fas fa-chart-bar" style="color: #6366f1;"></i>
          Analytics & Insights
        </h2>
        
        <div class="card" style="margin-bottom: 18px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h3 style="margin: 0;">Status Distribution</h3>
            <select id="user-status-date-filter" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 13px; background: white; cursor: pointer;">
              <option value="all">All Time</option>
              <option value="today">Today</option>
              <option value="yesterday">Yesterday</option>
              <option value="week">This Week</option>
              <option value="15days">Last 15 Days</option>
              <option value="30days">Last 30 Days</option>
              <option value="custom">Custom Range</option>
            </select>
          </div>
          <div id="user-status-custom-date-range" style="display: none; margin-bottom: 12px; display: flex; gap: 10px; align-items: center;">
            <input type="date" id="user-status-start-date" style="padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px;">
            <span style="color: #6b7280;">to</span>
            <input type="date" id="user-status-end-date" style="padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px;">
            <button onclick="applyUserStatusCustomDateFilter()" class="btn btn-primary" style="padding: 6px 12px; font-size: 12px;">Apply</button>
          </div>
          <canvas id="user-status-chart" style="max-height: 300px;"></canvas>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr; gap: 18px;">
          <div class="card">
            <h3 style="display: flex; align-items: center; gap: 8px;">
              <i class="fas fa-chart-line" style="color: #047857;"></i>
              Performance Metrics
            </h3>
            <div style="display: flex; flex-direction: column; gap: 14px; margin-top: 14px;">
              <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f3f4f6;">
                <span style="color: #6b7280; font-size: 14px;">Conversion Rate</span>
                <span id="conversion-rate" style="font-weight: 600; color: #047857;">0%</span>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f3f4f6;">
                <span style="color: #6b7280; font-size: 14px;">Avg. Follow-ups</span>
                <span id="avg-followups" style="font-weight: 600;">0</span>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 10px 0;">
                <span style="color: #6b7280; font-size: 14px;">Active Leads</span>
                <span id="active-leads" style="font-weight: 600; color: #0369a1;">0</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
  
  <!--Lead Detail Modal -->
  <div id="lead-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      
      <div style="margin-bottom: 16px;">
        <h2 id="modal-lead-name" style="margin: 0;"></h2>
      </div>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
        <!-- Left Column: Basic Details -->
        <div class="lead-details" style="border-right: 1px solid #e5e7eb; padding-right: 20px;">
          <p style="margin: 8px 0; font-size: 14px;"><strong>Contact:</strong> <span id="modal-lead-contact"></span></p>
          <p style="margin: 8px 0; font-size: 14px;"><strong>Email:</strong> <span id="modal-lead-email"></span></p>
          <p style="margin: 8px 0; font-size: 14px;"><strong>City:</strong> <span id="modal-lead-city"></span></p>
          <p style="margin: 8px 0; font-size: 14px;"><strong>Source:</strong> <span id="modal-lead-source"></span></p>
          <p style="margin: 8px 0; font-size: 14px;"><strong>Profession:</strong> <span id="modal-lead-profession"></span></p>
        </div>
        
        <!-- Right Column: University/Course Details -->
        <div class="lead-details">
          <div style="margin: 8px 0; font-size: 14px;">
            <strong>University:</strong>
            <div style="display: flex; gap: 8px; margin-top: 4px;">
              <input type="text" id="modal-lead-university" style="flex: 1; padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 13px;">
              <button onclick="updateLeadField('university')" class="btn btn-primary" style="padding: 6px 12px; font-size: 12px;"><i class="fas fa-save"></i></button>
            </div>
          </div>
          <div style="margin: 8px 0; font-size: 14px;">
            <strong>Course:</strong>
            <div style="display: flex; gap: 8px; margin-top: 4px;">
              <input type="text" id="modal-lead-course" style="flex: 1; padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 13px;">
              <button onclick="updateLeadField('course')" class="btn btn-primary" style="padding: 6px 12px; font-size: 12px;"><i class="fas fa-save"></i></button>
            </div>
          </div>
          <div style="margin-top: 12px;">
            <button onclick="copyLeadDetails()" class="btn" style="padding: 6px 12px; font-size: 12px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; display: flex; align-items: center; gap: 4px; transition: all 0.2s;" onmouseover="this.style.background='#e5e7eb'" onmouseout="this.style.background='#f3f4f6'">
              <i class="fas fa-copy" style="font-size: 11px;"></i> Copy All Details
            </button>
          </div>
        </div>
      </div>

      <div style="margin-bottom: 20px;">
        <div id="modal-lead-brochure" style="margin-bottom: 12px;"></div>
        <div id="modal-lead-whatsapp"></div>
      </div>

      <!-- Update on Lead Section -->
      <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border: 2px solid #0ea5e9; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
        <h3 style="margin: 0 0 16px 0; color: #0c4a6e; font-size: 16px; display: flex; align-items: center; gap: 8px;">
          <i class="fas fa-bolt" style="color: #0ea5e9;"></i>
          Update on Lead
        </h3>
        
        <div class="form-group" style="margin-bottom: 12px;">
          <label for="modal-lead-status" style="font-weight: 600; color: #0c4a6e; margin-bottom: 6px;">Status (Optional):</label>
          <select id="modal-lead-status" style="width: 100%; padding: 10px; border: 2px solid #bae6fd; border-radius: 8px; font-size: 14px;">
            <option value="">-- Keep Current Status --</option>
            <option value="Fresh">Fresh</option>
            <option value="Buffer fresh">Buffer fresh</option>
            <option value="Did not pick">Did not pick</option>
            <option value="Request call back">Request call back</option>
            <option value="Follow up">Follow up</option>
            <option value="Counselled">Counselled</option>
            <option value="Interested in next batch">Interested in next batch</option>
            <option value="Registration fees paid">Registration fees paid</option>
            <option value="Enrolled">Enrolled</option>
            <option value="Junk/not interested">Junk/not interested</option>
          </select>
        </div>
        
        <div class="form-group" style="margin-bottom: 12px;">
          <label for="quick-update-note" style="font-weight: 600; color: #0c4a6e; margin-bottom: 6px;">Follow-up Note (Optional):</label>
          <textarea id="quick-update-note" placeholder="Add a note about this interaction..." rows="3" style="width: 100%; padding: 10px; border: 2px solid #bae6fd; border-radius: 8px; font-size: 14px; resize: vertical;"></textarea>
        </div>
        
        <div class="form-group" style="margin-bottom: 16px;">
          <label for="modal-followup-datetime" style="font-weight: 600; color: #0c4a6e; margin-bottom: 6px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-phone" style="color: #0ea5e9;"></i>
            Schedule Next Call (Optional):
          </label>
          <input type="datetime-local" id="modal-followup-datetime" style="width: 100%; padding: 10px; border: 2px solid #bae6fd; border-radius: 8px; font-size: 14px;">
          <div id="current-followup-display" style="display: none; margin-top: 10px; padding: 10px; background: #eff6ff; border-radius: 6px; border: 1px solid #bfdbfe;">
            <p style="margin: 0; font-size: 13px; color: #1e40af;">
              <i class="fas fa-bell" style="margin-right: 6px;"></i>
              <strong>Current Scheduled:</strong> <span id="followup-display-time"></span>
            </p>
          </div>
        </div>
        
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
          <button onclick="quickUpdateLead()" class="btn btn-primary" style="flex: 1; min-width: 150px; font-size: 15px; padding: 12px; background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%); border: none;">
            <i class="fas fa-check-circle"></i> Update Lead
          </button>
          <button onclick="clearFollowUp()" class="btn btn-secondary" style="white-space: nowrap; padding: 12px 20px;">
            <i class="fas fa-times"></i> Clear Schedule
          </button>
        </div>
      </div>
      
      
      <h3 style="margin-top: 24px; color: #1e293b; font-size: 15px; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px;">Timeline</h3>
      <div id="timeline-container" class="notes-list"></div>
      
    </div>
  </div>
  
  <!-- Notification Panel -->
  <div id="notification-panel" style="display:none; position:fixed; top:70px; right:20px; width:380px; max-height:600px; background:white; border-radius:12px; box-shadow:0 10px 40px rgba(0,0,0,0.2); z-index:10000; border:1px solid #e5e7eb; overflow:hidden;">
    <div style="background:linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); padding:16px; color:white; display:flex; justify-content:space-between; align-items:center;">
      <div style="display:flex; align-items:center; gap:10px;">
        <i class="fas fa-bell" style="font-size:18px;"></i>
        <h3 style="margin:0; font-size:16px; font-weight:600;">Follow-up Reminders</h3>
      </div>
      <button onclick="closeNotificationPanel()" style="background:none; border:none; color:white; font-size:20px; cursor:pointer; padding:0; width:24px; height:24px;">&times;</button>
    </div>
    <div id="notification-list" style="max-height:500px; overflow-y:auto;">
      <p style="text-align:center; color:#9ca3af; padding:30px 20px; margin:0;">No pending reminders</p>
    </div>
  </div>
  
  <!-- Single Reminder Popup (for immediate alert) -->
  <div id="reminder-popup" style="display:none; position:fixed; top:20px; right:20px; width:350px; background:white; border-radius:12px; box-shadow:0 10px 40px rgba(0,0,0,0.2); z-index:20000; border:2px solid #6366f1; animation: slideInRight 0.3s ease;">
    <div style="background:linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); padding:16px; border-radius:10px 10px 0 0; color:white; display:flex; justify-content:space-between; align-items:center;">
      <div style="display:flex; align-items:center; gap:10px;">
        <i class="fas fa-bell" style="font-size:20px; animation: ring 1s ease-in-out infinite;"></i>
        <h3 style="margin:0; font-size:16px; font-weight:600;">Follow-up Reminder!</h3>
      </div>
      <button onclick="closeReminderPopup()" style="background:none; border:none; color:white; font-size:20px; cursor:pointer; padding:0; width:24px; height:24px;">&times;</button>
    </div>
    <div style="padding:20px;">
      <p style="margin:0 0 12px; color:#374151; font-size:14px; font-weight:500;" id="reminder-message">Time to follow up with this lead:</p>
      <div style="background:#f9fafb; padding:12px; border-radius:8px; border:1px solid #e5e7eb; margin-bottom:16px;">
        <p style="margin:0 0 6px; font-size:15px; font-weight:600; color:#111827;" id="reminder-lead-name"></p>
        <p style="margin:0 0 4px; font-size:13px; color:#6b7280;"><i class="fas fa-phone" style="margin-right:6px;"></i><span id="reminder-lead-contact"></span></p>
        <p style="margin:0; font-size:13px; color:#6b7280;"><i class="fas fa-envelope" style="margin-right:6px;"></i><span id="reminder-lead-email"></span></p>
      </div>
      <div style="display:flex; gap:10px;">
        <button onclick="openLeadFromReminder()" class="btn btn-primary" style="flex:1; font-size:14px;">
          <i class="fas fa-external-link-alt"></i> Open Lead
        </button>
        <button onclick="snoozeReminder()" class="btn btn-secondary" style="font-size:14px;">
          <i class="fas fa-clock"></i> Snooze 15min
        </button>
      </div>
    </div>
  </div>
  
  <!-- Loading Overlay with Progress -->
  <div id="loading-overlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.7); z-index: 9999; backdrop-filter: blur(4px);">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px 40px; border-radius: 12px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); min-width: 320px; text-align: center;">
      <div style="margin-bottom: 20px;">
        <div style="width: 60px; height: 60px; border: 4px solid #e5e7eb; border-top-color: #3b82f6; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
      </div>
      <div id="loading-message" style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 8px;">Processing...</div>
      <div id="loading-submessage" style="font-size: 13px; color: #6b7280;">Please wait</div>
    </div>
  </div>
  
  <!-- Welcome Congratulations Modal -->
  <div id="welcome-modal" class="modal" style="display:none; z-index: 10002; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px);" onclick="event.stopPropagation()">
    <div class="modal-content" style="max-width: 550px; text-align: center; padding: 40px; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);" onclick="event.stopPropagation()">
      <div style="font-size: 72px; margin-bottom: 20px; animation: celebrateScale 0.6s ease-out;">
        ðŸŽ‰
      </div>
      <h2 style="margin: 0 0 16px 0; color: #1f2937; font-size: 32px; font-weight: 800;">Welcome to DD CRM!</h2>
      <p style="font-size: 18px; color: #6b7280; margin-bottom: 8px; font-weight: 600;" id="welcome-user-name">Hello, User!</p>
      <p style="font-size: 15px; color: #9ca3af; line-height: 1.6; margin-bottom: 28px;">
        Congratulations on joining our team! We're thrilled to have you on board. 
        Let's take a quick tour to help you get started with your new dashboard.
      </p>
      <button onclick="startTutorial()" class="btn btn-primary" style="padding: 14px 32px; font-size: 16px; font-weight: 600; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4); width: 100%;">
        <i class="fas fa-play-circle"></i> Start Tutorial
      </button>
      <button onclick="skipTutorial()" class="btn btn-secondary" style="margin-top: 12px; padding: 10px 24px; font-size: 14px; width: 100%;">
        Skip for now
      </button>
    </div>
  </div>

  <!-- Tutorial Overlay -->
  <div id="tutorial-overlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.75); z-index: 9999; backdrop-filter: blur(2px);"></div>
  
  <!-- Tutorial Tooltip -->
  <div id="tutorial-tooltip" style="display: none; position: fixed; z-index: 10001; background: white; border-radius: 12px; padding: 24px; box-shadow: 0 12px 40px rgba(0,0,0,0.3); max-width: 400px; animation: tooltipFadeIn 0.3s ease;">
    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
      <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;">
        <span id="tutorial-step-indicator">Step 1 of 7</span>
      </div>
      <button onclick="endTutorial()" style="background: none; border: none; color: #9ca3af; cursor: pointer; font-size: 18px; padding: 0; line-height: 1;" title="Skip Tutorial">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <h3 id="tutorial-title" style="margin: 0 0 12px 0; color: #1f2937; font-size: 20px; font-weight: 700;">Title</h3>
    <p id="tutorial-description" style="margin: 0 0 20px 0; color: #6b7280; font-size: 14px; line-height: 1.6;">Description</p>
    <div style="display: flex; gap: 12px;">
      <button id="tutorial-prev-btn" onclick="previousTutorialStep()" class="btn btn-secondary" style="flex: 1; display: none;">
        <i class="fas fa-arrow-left"></i> Previous
      </button>
      <button id="tutorial-next-btn" onclick="nextTutorialStep()" class="btn btn-primary" style="flex: 2; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
        Next <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </div>
  
  <!-- Confirmation Modal -->
  <div id="confirmation-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 9998; backdrop-filter: blur(2px);">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 24px; border-radius: 12px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3); min-width: 400px; max-width: 500px;">
      <div style="margin-bottom: 16px;">
        <h3 id="confirm-title" style="font-size: 18px; font-weight: 600; color: #1f2937; margin: 0 0 8px 0;">Confirm Action</h3>
        <p id="confirm-message" style="font-size: 14px; color: #6b7280; margin: 0; line-height: 1.5;"></p>
      </div>
      <div style="display: flex; gap: 12px; justify-content: flex-end;">
        <button onclick="closeConfirmModal()" class="btn" style="padding: 8px 16px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db;">
          <i class="fas fa-times"></i> Cancel
        </button>
        <button id="confirm-action-btn" class="btn btn-primary" style="padding: 8px 16px;">
          <i class="fas fa-check"></i> Confirm
        </button>
      </div>
    </div>
  </div>
  
  <!-- Toast Notification -->
  <div id="toast-notification" style="display: none; position: fixed; top: 80px; right: 20px; background: white; padding: 16px 20px; border-radius: 8px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2); z-index: 10000; min-width: 300px; max-width: 400px; border-left: 4px solid #10b981;">
    <div style="display: flex; align-items: start; gap: 12px;">
      <i id="toast-icon" class="fas fa-check-circle" style="font-size: 20px; color: #10b981; margin-top: 2px;"></i>
      <div style="flex: 1;">
        <div id="toast-title" style="font-weight: 600; color: #1f2937; margin-bottom: 4px;">Success</div>
        <div id="toast-message" style="font-size: 13px; color: #6b7280; line-height: 1.4;"></div>
      </div>
      <button onclick="closeToast()" style="background: none; border: none; color: #9ca3af; cursor: pointer; font-size: 18px; padding: 0; line-height: 1;">Ã—</button>
    </div>
  </div>
  
  <style>
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    @keyframes slideIn {
      from { transform: translateX(400px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes celebrateScale {
      0% { transform: scale(0); opacity: 0; }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); opacity: 1; }
    }
    @keyframes tooltipFadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes highlightPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
      50% { box-shadow: 0 0 0 15px rgba(102, 126, 234, 0); }
    }
    .tutorial-highlight {
      position: relative;
      z-index: 10000 !important;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.8), 0 0 40px rgba(102, 126, 234, 0.5) !important;
      border-radius: 8px !important;
      animation: highlightPulse 2s infinite;
    }
    #toast-notification {
      animation: slideIn 0.3s ease-out;
    }
  </style>
  
  <!-- Footer -->
  <footer style="position:fixed; bottom:0; left:260px; right:0; padding:10px 20px; background:rgba(249,250,251,0.95); border-top:1px solid #e5e7eb; font-size:11px; color:#6b7280; text-align:center; z-index:100; backdrop-filter: blur(8px);">
    <span>Â© 2025 DegreeDrishti. All rights reserved.</span>
    <span style="margin-left:16px; color:#9ca3af;">Developed by Samarth</span>
  </footer>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>
  <script src="js/config.js?v=1.2" defer></script>
  <script src="js/user.js?v=1.2" defer></script>
</body>
</html>
